machine:
  environment:
    XCODE_SCHEME: Bazaarr
    XCODE_PROJECT: Bazaarr.xcodeproj
    DEVELOPER_NAME: 'iPhone Developer Shoaib Mian (4S4W7X8E3X)'
    APPNAME: Bazaarr
    PROFILE_UUID: b93be6c8-0c61-43ce-acb3-b308591d8b0e
dependencies:
    pre:
      - sudo gem install shenzhen
      - brew install node
    cache_directories:
      - "node_modules"
    post:
      - npm install -g gulp
      - bower install
deployment:
    hockey:
      branch: master
      commands:
        - npm install -g cordova ionic
        - ionic upload --email $IONIC_EMAIL --password $IONIC_PASSWORD
        - ionic build --release ios
        - cd platforms/ios/
        - ./scripts/add-key.sh
        - ipa build -c Distribution
        - ./scripts/remove-key.sh
        - ipa distribute:hockeyapp -m "circleci build" --token $HOCKEYAPP_TOKEN